:sourcesdir: ../../../../../../source

[[dm_security]]
====== Права доступа в DataManager

Методы `load()`, `loadList()`, `loadValues()` и `getCount()` проверяют наличие у пользователя <<permissions,права>> READ на загружаемую сущность. Кроме того, при извлечении сущностей из БД накладываются <<constraints,ограничения>> групп доступа.

Метод `commit()` проверяет наличие у пользователя права UPDATE на изменяемые сущности и DELETE на удаляемые.

По умолчанию, `DataManager` проверяет права на операции (READ/CREATE/UPDATE/DELETE) с сущностями, когда вызывается с клиентской стороны, и игнорирует их, когда вызывается из кода middleware. Права на атрибуты по умолчанию не проверяются.

Если вы хотите, чтобы `DataManager` проверял права на операции и при вызове на среднем слое, получите методом `DataManager.secure()` специальный объект-обертку и вызывайте методы у него. В качестве альтернативы, вы можете установить свойство приложения <<cuba.dataManagerChecksSecurityOnMiddleware,cuba.dataManagerChecksSecurityOnMiddleware>>, чтобы проверка прав работала для всего приложения.

Права на атрибуты будут проверяться на среднем слое только если вы дополнительно установите свойство приложения <<cuba.entityAttributePermissionChecking,cuba.entityAttributePermissionChecking>> в true. Это имеет смысл, если средний слой обслуживает также клиентов, которые теоретически могут быть взломаны, например, десктоп-клиент. В этом случае, установите также свойство <<cuba.keyForSecurityTokenEncryption,cuba.keyForSecurityTokenEncryption>> в уникальное значение. Если ваше приложение использует только Web или Portal клиентов, то оба данных свойства можно безопасно оставить со значениями по умолчанию.

Имейте в ввиду, что <<constraints,ограничения>> групп доступа (row-level security) применяются всегда, независимо от того, был ли вызов с клиентского или со среднего слоя.

См. раздел <<data_access_checks>> для получения полной картины того, как разрешения и ограничения доступа к данным используются различными механизмами фреймворка.
